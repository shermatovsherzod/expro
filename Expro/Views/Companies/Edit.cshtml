@model CompanyEditVM
@using Expro.ViewModels
@{
    ViewData["Title"] = "Редактирование компании";
    <link href="~/lib/treeselect/css/jquery.bootstrap.treeselect.css" rel="stylesheet" />
    <link href="~/lib/bootstrap-select-1.13.14/css/bootstrap-select.css" rel="stylesheet" />
}
<style>
    .bootstrap-select {
        border: 1px solid #ced4da !important;
        border-radius: .25rem;
    }
</style>

<h4>Редактирование компании</h4>
<hr />

<form asp-controller="Companies" asp-action="Edit" data-ajax="true" data-ajax-method="POST">
    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.CompanyName"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.CompanyName" class="form-control" />
                <span asp-validation-for="@Model.CompanyName"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.CompanyDescription"></label>
        </div>
        <div class="col-md-9">
            <p>
                <textarea asp-for="@Model.CompanyDescription" class="form-control"></textarea>
                <span asp-validation-for="@Model.CompanyDescription"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.LawAreas"></label>
        </div>
        <div class="col-md-9">
            <p>
                <select asp-for="@Model.LawAreas"
                        class="selectpicker form-control"
                        title="Выберите"
                        multiple
                        data-selected-text-format="count > 3"
                        data-language="ru_RU">
                    @{
                        var items = ViewData["lawAreas"] as List<SelectListItemWithParent>;
                        var parentItems = items.Where(m => m.ParentValue == "").ToList();
                        for (int i = 0; i < parentItems.Count; i++)
                        {
                            <option value="@parentItems[i].Value" data-content="<b>@parentItems[i].Text</b>">@parentItems[i].Text</option>

                            var childItems = items.Where(m => m.ParentValue == parentItems[i].Value).ToList();
                            foreach (var childItem in childItems)
                            {
                                <option value="@childItem.Value" data-content="- @childItem.Text">@childItem.Text</option>
                            }

                            if (i < parentItems.Count - 1)
                            {
                                <option data-divider="true"></option>
                            }
                        }
                    }
                </select>
                <span asp-validation-for="@Model.LawAreas" class="text-danger"></span>
            </p>
        </div>
    </div>


    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.RegionID"></label>
        </div>
        <div class="col-md-9">
            <p>
                <select asp-for="@Model.RegionID"
                        asp-items="@ViewData["regions"] as IEnumerable<SelectListItem>"
                        class="form-control">
                    <option disabled selected>--- Выбрать регион ---</option>
                </select>
                <span asp-validation-for="@Model.RegionID" class="text-danger"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.CityID"></label>
        </div>
        <div class="col-md-9">
            <p>
                <select asp-for="@Model.CityID"
                        asp-items="@ViewData["cities"] as IEnumerable<SelectListItem>"
                        class="form-control">
                    <option disabled selected>--- Выбрать город ---</option>
                </select>
                <span asp-validation-for="@Model.CityID" class="text-danger"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.CityOther"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.CityOther" class="form-control" />
                <span asp-validation-for="@Model.CityOther" class="text-danger"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.WebSite"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.WebSite" class="form-control" />
                <span asp-validation-for="@Model.WebSite" class="text-danger"></span>
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.PhoneNumber"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.PhoneNumber" class="form-control" />
                <span asp-validation-for="@Model.PhoneNumber" class="text-danger"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.Email"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.Email" class="form-control" />
                <span asp-validation-for="@Model.Email" class="text-danger"></span>
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <label asp-for="@Model.Address"></label>
        </div>
        <div class="col-md-9">
            <p>
                <input asp-for="@Model.Address" class="form-control" />
                <span asp-validation-for="@Model.Address" class="text-danger"></span>
            </p>
        </div>
    </div>
    <button type="submit" class="btn btn-success">Сохранить</button>

</form>


<div>
    <a asp-action="Index">Вернутся к списку</a>
</div>

@section Scripts{
    <script src="~/lib/bootstrap-select-1.13.14/js/bootstrap-select.js"></script>
    <script src="~/lib/bootstrap-select-1.13.14/js/i18n/defaults-ru_RU.js"></script>

}
